<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cricket API Data Filter</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }

        .header p {
            margin: 10px 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }

        .controls {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #6c757d;
            font-size: 1.1em;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results {
            padding: 30px;
        }

        .summary {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid #2196f3;
        }

        .match-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .match-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .match-header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 15px 20px;
            font-weight: 600;
        }

        .match-teams {
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .match-details {
            opacity: 0.9;
            font-size: 0.9em;
        }

        .match-body {
            padding: 20px;
        }

        .match-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .info-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .info-section h4 {
            margin: 0 0 10px;
            color: #1e3c72;
            font-size: 1.1em;
        }

        .info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid #e9ecef;
        }

        .info-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .info-label {
            font-weight: 500;
            color: #495057;
        }

        .info-value {
            color: #212529;
            font-weight: 600;
        }

        .innings-section {
            margin-top: 20px;
        }

        .innings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .innings-card {
            background: #fff3e0;
            border: 1px solid #ffcc02;
            border-radius: 8px;
            padding: 15px;
        }

        .innings-title {
            font-weight: 600;
            color: #f57f17;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .code-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }

        .code-section h3 {
            margin-top: 0;
            color: #1e3c72;
        }

        pre {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 14px;
            line-height: 1.5;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #f44336;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .controls {
                padding: 20px;
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
            
            button {
                width: 100%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèè Cricket API Data Filter</h1>
            <p>Extract essential match information from Play Cricket API</p>
        </div>

        <div class="controls">
            <div class="button-group">
                <button onclick="fetchAndFilterData()" id="fetchBtn">
                    üìä Fetch & Filter Live Data
                </button>
                <button onclick="showFilteredExample()" id="exampleBtn">
                    üìã Show Example Output
                </button>
                <button onclick="downloadJSON()" id="downloadBtn" disabled>
                    üíæ Download JSON
                </button>
                <button onclick="showCode()" id="codeBtn">
                    üíª View Code
                </button>
            </div>
        </div>

        <div id="content">
            <div class="results">
                <div class="summary">
                    <h3>üéØ What This Filter Extracts:</h3>
                    <ul>
                        <li><strong>Essential Match Info:</strong> Date, teams, ground, result, competition</li>
                        <li><strong>Match Format:</strong> Type, overs, game format, season</li>
                        <li><strong>Key Results:</strong> Runs, wickets, overs, extras per innings</li>
                        <li><strong>Match Status:</strong> Current status, last updated, toss info</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentFilteredData = null;

        // Cricket API Data Filter - Extract Essential Match Information Only
        function filterCricketData(apiResponse) {
            const filteredMatches = apiResponse.result_summary.map(match => {
                // Essential Match Information (Must Have)
                const essentialInfo = {
                    match_date: match.match_date,
                    home_club_name: match.home_club_name,
                    away_club_name: match.away_club_name,
                    home_team_name: match.home_team_name,
                    away_team_name: match.away_team_name,
                    ground_name: match.ground_name,
                    result_description: match.result_description,
                    competition_name: match.competition_name,
                    competition_type: match.competition_type
                };

                // Match Format & Context
                const matchFormat = {
                    match_type: match.match_type,
                    game_type: match.game_type,
                    no_of_overs: match.no_of_overs,
                    season: "2025" // From your API URL parameter
                };

                // Key Result Data from innings array
                const inningsData = match.innings.map(innings => ({
                    team_batting_id: innings.team_batting_id,
                    innings_number: innings.innings_number,
                    runs: innings.runs,
                    wickets: innings.wickets,
                    overs: innings.overs,
                    total_extras: innings.total_extras
                }));

                // Match Status
                const matchStatus = {
                    status: match.status,
                    last_updated: match.last_updated,
                    toss: match.toss
                };

                // Combine all filtered data
                return {
                    // Unique match identifier (helpful for tracking)
                    match_id: match.id,
                    
                    // Essential Match Information
                    ...essentialInfo,
                    
                    // Match Format & Context
                    ...matchFormat,
                    
                    // Match Status
                    ...matchStatus,
                    
                    // Key Result Data
                    innings: inningsData
                };
            });

            return {
                total_matches: filteredMatches.length,
                matches: filteredMatches
            };
        }

        // Fetch live data from API
        async function fetchAndFilterData() {
            const fetchBtn = document.getElementById('fetchBtn');
            const downloadBtn = document.getElementById('downloadBtn');
            const content = document.getElementById('content');
            
            fetchBtn.disabled = true;
            fetchBtn.innerHTML = 'üîÑ Fetching...';
            
            content.innerHTML = `
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Fetching cricket data from API...</p>
                </div>
            `;

            try {
                const response = await fetch(
                    'http://play-cricket.com/api/v2/result_summary.json?site_id=1786&season=2025&api_token=8786d7c44061b7d624367d32177420e0'
                );
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                currentFilteredData = filterCricketData(data);
                
                displayFilteredData(currentFilteredData);
                downloadBtn.disabled = false;
                
            } catch (error) {
                content.innerHTML = `
                    <div class="error">
                        <h3>‚ùå Error fetching data</h3>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p><strong>Note:</strong> This might be due to CORS restrictions. Try running this code on a server or use the example data instead.</p>
                    </div>
                `;
                console.error('Error fetching cricket data:', error);
            } finally {
                fetchBtn.disabled = false;
                fetchBtn.innerHTML = 'üìä Fetch & Filter Live Data';
            }
        }

        // Show example with sample data
        function showFilteredExample() {
            const exampleData = {
                total_matches: 2,
                matches: [
                    {
                        match_id: 7157908,
                        match_date: "28/05/2024",
                        home_club_name: "Bancroft Lions CC",
                        away_club_name: "Chelmsford CC",
                        home_team_name: "Girls Under 13",
                        away_team_name: "Girls Under 13",
                        ground_name: "Lions Ground",
                        result_description: "Bancroft Lions CC - Girls Under 13 - Won",
                        competition_name: "Girls U13 ODS: Group A",
                        competition_type: "League",
                        match_type: "Limited Overs",
                        game_type: "Junior",
                        no_of_overs: "6",
                        season: "2025",
                        status: "Complete",
                        last_updated: "07/08/2025",
                        toss: "Bancroft Lions CC won the toss and elected to bat",
                        innings: [
                            {
                                team_batting_id: "243171",
                                innings_number: 1,
                                runs: "85",
                                wickets: "4",
                                overs: "6.0",
                                total_extras: "12"
                            },
                            {
                                team_batting_id: "184437",
                                innings_number: 1,
                                runs: "78",
                                wickets: "8",
                                overs: "5.3",
                                total_extras: "15"
                            }
                        ]
                    },
                    {
                        match_id: 6717996,
                        match_date: "12/04/2025",
                        home_club_name: "Chelmsford CC",
                        away_club_name: "Springfield CC, Essex",
                        home_team_name: "Sat 1st XI",
                        away_team_name: "1st XI",
                        ground_name: "Chelmer Park",
                        result_description: "Chelmsford CC - Sat 1st XI - Won",
                        competition_name: "",
                        competition_type: "Friendly",
                        match_type: "Limited Overs",
                        game_type: "Standard",
                        no_of_overs: "",
                        season: "2025",
                        status: "Complete",
                        last_updated: "12/04/2025",
                        toss: "Springfield CC, Essex - 1st XI won the toss and elected to field",
                        innings: [
                            {
                                team_batting_id: "24293",
                                innings_number: 1,
                                runs: "276",
                                wickets: "10",
                                overs: "47.3",
                                total_extras: "17"
                            },
                            {
                                team_batting_id: "34198",
                                innings_number: 1,
                                runs: "204",
                                wickets: "10",
                                overs: "49.5",
                                total_extras: "19"
                            }
                        ]
                    }
                ]
            };
            
            currentFilteredData = exampleData;
            displayFilteredData(exampleData);
            document.getElementById('downloadBtn').disabled = false;
        }

        // Display filtered data in the UI
        function displayFilteredData(data) {
            const content = document.getElementById('content');
            
            let html = `
                <div class="results">
                    <div class="summary">
                        <h3>üìà Filtered Results Summary</h3>
                        <p><strong>Total Matches:</strong> ${data.total_matches}</p>
                        <p><strong>Data extracted:</strong> Essential match info, format details, results, and status</p>
                    </div>
            `;

            data.matches.forEach(match => {
                html += `
                    <div class="match-card">
                        <div class="match-header">
                            <div class="match-teams">
                                ${match.home_club_name} ${match.home_team_name} vs ${match.away_club_name} ${match.away_team_name}
                            </div>
                            <div class="match-details">
                                ${match.match_date} ‚Ä¢ ${match.competition_type} ‚Ä¢ ${match.result_description}
                            </div>
                        </div>
                        <div class="match-body">
                            <div class="match-info">
                                <div class="info-section">
                                    <h4>üèè Match Details</h4>
                                    <div class="info-item">
                                        <span class="info-label">Match ID:</span>
                                        <span class="info-value">${match.match_id}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Date:</span>
                                        <span class="info-value">${match.match_date}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Ground:</span>
                                        <span class="info-value">${match.ground_name || 'TBC'}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Status:</span>
                                        <span class="info-value">${match.status}</span>
                                    </div>
                                </div>
                                
                                <div class="info-section">
                                    <h4>üéØ Competition</h4>
                                    <div class="info-item">
                                        <span class="info-label">Competition:</span>
                                        <span class="info-value">${match.competition_name || 'Friendly'}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Type:</span>
                                        <span class="info-value">${match.competition_type}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Match Type:</span>
                                        <span class="info-value">${match.match_type}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Overs:</span>
                                        <span class="info-value">${match.no_of_overs || 'Declaration'}</span>
                                    </div>
                                </div>
                                
                                <div class="info-section">
                                    <h4>‚ö° Match Info</h4>
                                    <div class="info-item">
                                        <span class="info-label">Game Type:</span>
                                        <span class="info-value">${match.game_type}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Season:</span>
                                        <span class="info-value">${match.season}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Last Updated:</span>
                                        <span class="info-value">${match.last_updated}</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="info-label">Toss:</span>
                                        <span class="info-value">${match.toss || 'Not recorded'}</span>
                                    </div>
                                </div>
                            </div>
                            
                            ${match.innings.length > 0 ? `
                                <div class="innings-section">
                                    <h4>üìä Innings Results</h4>
                                    <div class="innings-grid">
                                        ${match.innings.map(innings => `
                                            <div class="innings-card">
                                                <div class="innings-title">Innings ${innings.innings_number}</div>
                                                <div class="info-item">
                                                    <span class="info-label">Runs:</span>
                                                    <span class="info-value">${innings.runs || 'N/A'}</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Wickets:</span>
                                                    <span class="info-value">${innings.wickets || 'N/A'}</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Overs:</span>
                                                    <span class="info-value">${innings.overs || 'N/A'}</span>
                                                </div>
                                                <div class="info-item">
                                                    <span class="info-label">Extras:</span>
                                                    <span class="info-value">${innings.total_extras || 'N/A'}</span>
                                                </div>
                                            </div>
                                        `).join('')}
                                    </div>
                                </div>
                            ` : '<p><em>No innings data available</em></p>'}
                        </div>
                    </div>
                `;
            });

            html += '</div>';
            content.innerHTML = html;
        }

        // Download filtered data as JSON
        function downloadJSON() {
            if (!currentFilteredData) {
                alert('No data to download. Please fetch data first.');
                return;
            }

            const dataStr = JSON.stringify(currentFilteredData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `cricket_filtered_data_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // Show the JavaScript code
        function showCode() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="results">
                    <div class="code-section">
                        <h3>üíª JavaScript Filter Function</h3>
                        <p>Here's the core function that filters the cricket API data:</p>
                        <pre><code>// Cricket API Data Filter - Extract Essential Match Information Only
function filterCricketData(apiResponse) {
    const filteredMatches = apiResponse.result_summary.map(match => {
        // Essential Match Information (Must Have)
        const essentialInfo = {
            match_date: match.match_date,
            home_club_name: match.home_club_name,
            away_club_name: match.away_club_name,
            home_team_name: match.home_team_name,
            away_team_name: match.away_team_name,
            ground_name: match.ground_name,
            result_description: match.result_description,
            competition_name: match.competition_name,
            competition_type: match.competition_type
        };

        // Match Format & Context
        const matchFormat = {
            match_type: match.match_type,
            game_type: match.game_type,
            no_of_overs: match.no_of_overs,
            season: "2025" // From your API URL parameter
        };

        // Key Result Data from innings array
        const inningsData = match.innings.map(innings => ({
            team_batting_id: innings.team_batting_id,
            innings_number: innings.innings_number,
            runs: innings.runs,
            wickets: innings.wickets,
            overs: innings.overs,
            total_extras: innings.total_extras
        }));

        // Match Status
        const matchStatus = {
            status: match.status,
            last_updated: match.last_updated,
            toss: match.toss
        };

        // Combine all filtered data
        return {
            match_id: match.id,
            ...essentialInfo,
            ...matchFormat,
            ...matchStatus,
            innings: inningsData
        };
    });

    return {
        total_matches: filteredMatches.length,
        matches: filteredMatches
    };
}

// Usage example:
async function getCricketData() {
    const response = await fetch('YOUR_API_URL');
    const data = await response.json();
    const filteredData = filterCricketData(data);
    console.log(filteredData);
}</code></pre>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
