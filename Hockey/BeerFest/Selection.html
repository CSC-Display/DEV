<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chelmsford Hockey Club Beer & Cider Festival - November 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid #333;
        }

        h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .sponsor {
            margin: 10px 0;
            font-size: 1em;
        }

        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .section h2 {
            font-size: 1.4em;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid #ddd;
        }

        .section h3 {
            font-size: 1.1em;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .item-header {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            padding: 10px 0;
            font-weight: bold;
            border-bottom: 2px solid #333;
            margin-bottom: 10px;
        }

        .beer-item, .cider-item {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
            align-items: center;
        }

        .beer-info {
            display: flex;
            flex-direction: column;
        }

        .beer-name {
            font-weight: bold;
            font-size: 1em;
        }

        .brewery {
            color: #666;
            font-size: 0.9em;
        }

        .abv {
            font-weight: bold;
        }

        .stock {
            text-align: right;
            padding-left: 10px;
        }

        .stock-bar-container {
            display: flex;
            gap: 3px;
            justify-content: flex-end;
            align-items: center;
        }

        .stock-box {
            width: 18px;
            height: 18px;
            border: 2px solid #333;
            background-color: #e0e0e0;
            transition: background-color 0.3s ease;
        }

        .stock-box.filled {
            background-color: #44aa44;
        }

        .loading {
            color: #999;
            font-style: italic;
        }

        .sponsors-section {
            padding-top: 20px;
            border-top: 2px solid #333;
            text-align: center;
        }

        .sponsors-section h2 {
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .sponsors-list {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .sponsor-item {
            padding: 5px 15px;
            background: #f0f0f0;
        }

        @media (max-width: 1000px) {
            .content-grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        @media (max-width: 600px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Chelmsford Hockey Club</h1>
            <div class="subtitle">Beer & Cider Festival</div>
            <div class="sponsor">Proudly sponsored by Gray & Sons</div>
            <div class="sponsor">November 2025</div>
        </header>

        <div class="content-grid">
            <!-- Festival Beers Section -->
            <div class="section">
                <h2>Festival Beers</h2>
                
                <div class="item-header">
                    <div>Name / Brewery</div>
                    <div>ABV</div>
                    <div style="text-align: right;">Stock Level</div>
                </div>
                
                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">LIONHEART</div>
                        <div class="brewery">Mighty Oak Brewery</div>
                    </div>
                    <div class="abv">3.6%</div>
                    <div class="stock" data-drink="LIONHEART">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">RIBBLEHEAD BITTER</div>
                        <div class="brewery">Settle Brewery</div>
                    </div>
                    <div class="abv">3.8%</div>
                    <div class="stock" data-drink="RIBBLEHEAD BITTER">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">PENNINE DARK MILD</div>
                        <div class="brewery">Tatton Brewery</div>
                    </div>
                    <div class="abv">3.9%</div>
                    <div class="stock" data-drink="PENNINE DARK MILD">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">LEGACY</div>
                        <div class="brewery">Brentwood Brewery</div>
                    </div>
                    <div class="abv">4.0%</div>
                    <div class="stock" data-drink="LEGACY">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">INFERNO</div>
                        <div class="brewery">Oakham Ales</div>
                    </div>
                    <div class="abv">4.0%</div>
                    <div class="stock" data-drink="INFERNO">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">SWEENEY TODD</div>
                        <div class="brewery">Colchester Brewery</div>
                    </div>
                    <div class="abv">4.2%</div>
                    <div class="stock" data-drink="SWEENEY TODD">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">SIX LITTLE SHIPS</div>
                        <div class="brewery">Leigh-on-Sea</div>
                    </div>
                    <div class="abv">4.2%</div>
                    <div class="stock" data-drink="SIX LITTLE SHIPS">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">LUSHINGTONS</div>
                        <div class="brewery">Skinners Brewery</div>
                    </div>
                    <div class="abv">4.2%</div>
                    <div class="stock" data-drink="LUSHINGTONS">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">HEART OF DARKNESS</div>
                        <div class="brewery">Wantsum</div>
                    </div>
                    <div class="abv">4.5%</div>
                    <div class="stock" data-drink="HEART OF DARKNESS">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">GRAVITAS</div>
                        <div class="brewery">Vale Brewery</div>
                    </div>
                    <div class="abv">4.8%</div>
                    <div class="stock" data-drink="GRAVITAS">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <h3>Behind the Bar</h3>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">CAPTAIN BOB</div>
                        <div class="brewery">Mighty Oak Brewery</div>
                    </div>
                    <div class="abv">3.8%</div>
                    <div class="stock" data-drink="CAPTAIN BOB">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">SILVER ADDER</div>
                        <div class="brewery">Mauldons Brewery</div>
                    </div>
                    <div class="abv">4.2%</div>
                    <div class="stock" data-drink="SILVER ADDER">
                        <span class="loading">Loading...</span>
                    </div>
                </div>
            </div>

            <!-- Cider Section -->
            <div class="section">
                <h2>Cider</h2>
                
                <div class="item-header">
                    <div>Name / Brewery</div>
                    <div>ABV</div>
                    <div style="text-align: right;">Stock Level</div>
                </div>
                
                <h3>Lilley's Cider</h3>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">FIREDANCER</div>
                    </div>
                    <div class="abv">4.5%</div>
                    <div class="stock" data-drink="FIREDANCER">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">SELECT</div>
                    </div>
                    <div class="abv">4.8%</div>
                    <div class="stock" data-drink="SELECT">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">RED RABBIT</div>
                    </div>
                    <div class="abv">6.0%</div>
                    <div class="stock" data-drink="RED RABBIT">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">BEE STING (Perry)</div>
                    </div>
                    <div class="abv">6.8%</div>
                    <div class="stock" data-drink="BEE STING (Perry)">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <h3>Lilley's Flavoured Cider</h3>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">ELDERFLOWER</div>
                    </div>
                    <div class="abv">3.4%</div>
                    <div class="stock" data-drink="ELDERFLOWER">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">PINA COLADA</div>
                    </div>
                    <div class="abv">3.4%</div>
                    <div class="stock" data-drink="PINA COLADA">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">RASPBERRY MOJITO</div>
                    </div>
                    <div class="abv">3.4%</div>
                    <div class="stock" data-drink="RASPBERRY MOJITO">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">WILD BERRY</div>
                    </div>
                    <div class="abv">3.4%</div>
                    <div class="stock" data-drink="WILD BERRY">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">MAN-GHOOOUL (Mango)</div>
                    </div>
                    <div class="abv">4.0%</div>
                    <div class="stock" data-drink="MAN-GHOOOUL (Mango)">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="cider-item">
                    <div class="beer-info">
                        <div class="beer-name">RHUBARB</div>
                    </div>
                    <div class="abv">4.0%</div>
                    <div class="stock" data-drink="RHUBARB">
                        <span class="loading">Loading...</span>
                    </div>
                </div>
            </div>

            <!-- Low Alcohol Section -->
            <div class="section">
                <h2>Low Alcohol (500ml bottles)</h2>

                <div class="item-header">
                    <div>Name / Brewery</div>
                    <div>ABV</div>
                    <div style="text-align: right;">Stock Level</div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">LOW TIDE</div>
                        <div class="brewery">Shipyard</div>
                    </div>
                    <div class="abv">0.5%</div>
                    <div class="stock" data-drink="LOW TIDE">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">PROPER JOB</div>
                        <div class="brewery">St Austell</div>
                    </div>
                    <div class="abv">0.5%</div>
                    <div class="stock" data-drink="PROPER JOB">
                        <span class="loading">Loading...</span>
                    </div>
                </div>

                <div class="beer-item">
                    <div class="beer-info">
                        <div class="beer-name">GHOST SHIP</div>
                        <div class="brewery">Adnams (club bar)</div>
                    </div>
                    <div class="abv">0.5%</div>
                    <div class="stock" data-drink="GHOST SHIP">
                        <span class="loading">Loading...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sponsors Section -->
        <div class="sponsors-section">
            <h2>Thank You to Our Sponsors</h2>
            <div class="sponsors-list">
                <div class="sponsor-item">David Carr Esq.</div>
                <div class="sponsor-item">Toby "Can't concede if you don't play" Stock</div>
                <div class="sponsor-item">FITBRAIN 4 KIDS</div>
                <div class="sponsor-item">Mens Vets</div>
                <div class="sponsor-item">Mens Evergreens</div>
                <div class="sponsor-item">Mens 1XI</div>
            </div>
        </div>
    </div>

    <script>
        // JSONBin configuration
        const API_KEY = '$2a$10$5J2bEaYJje4O1i40NLVVTu9u9Tz2kmlIl0xKoWpGr2vaIUPhp93ey';
        const BIN_ID = '690a223c43b1c97be9987c36';
        const API_URL = `https://api.jsonbin.io/v3/b/${BIN_ID}/latest`;

        // Function to create stock bar with quarters
        function createStockBar(percentage) {
            console.log('createStockBar called with:', percentage, 'type:', typeof percentage);
            const value = parseInt(percentage);
            console.log('Parsed value:', value);
            const filledBoxes = Math.round(value / 25);
            console.log('Filled boxes:', filledBoxes);
            
            let boxesHTML = '';
            for (let i = 0; i < 4; i++) {
                const filled = i < filledBoxes ? 'filled' : '';
                boxesHTML += `<div class="stock-box ${filled}"></div>`;
            }
            
            const result = `<div class="stock-bar-container">${boxesHTML}</div>`;
            console.log('Generated HTML:', result);
            return result;
        }

        // Fetch stock levels from JSONBin
        async function fetchStockLevels() {
            try {
                console.log('Fetching from:', API_URL);
                
                const response = await fetch(API_URL, {
                    headers: {
                        'X-Master-Key': API_KEY
                    }
                });

                console.log('Response status:', response.status);

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                console.log('Full API response:', data);
                
                const stockData = data.record.stockLevels;
                console.log('Stock data:', stockData);

                // Update all stock displays
                document.querySelectorAll('[data-drink]').forEach(element => {
                    const drinkName = element.getAttribute('data-drink');
                    const stockLevel = stockData[drinkName] || "0%";
                    console.log(`${drinkName}: ${stockLevel}`);
                    element.innerHTML = createStockBar(stockLevel);
                });

            } catch (error) {
                console.error('Error fetching stock levels:', error);
                document.querySelectorAll('[data-drink]').forEach(element => {
                    element.innerHTML = '<span style="color: #ff0000;">Error</span>';
                });
            }
        }

        // Fetch stock levels on page load
        fetchStockLevels();

        // Optionally refresh every 60 seconds
        setInterval(fetchStockLevels, 60000);
    </script>
</body>
</html>
